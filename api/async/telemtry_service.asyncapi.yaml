asyncapi: 3.0.0
info:
  title: Telemetry service async API
  version: 1.0.0

servers:
  kafkaServer:
    host: some.kafka.addr
    description: Kafka broker 
    protocol: kafka

operations:
  onTelemetryData:
    action: receive
    channel:
      $ref: '#/channels/telemetryData'
  
  

channels:
  telemetryData:
    description: This channel for telemetry data from devices.
    address: devices_telemetry_data
    messages:
      device_telemetryData:
        $ref: '#/components/messages/device_telemetryData'

components:
  messages:
    device_telemetryData:
      payload:
        type: object
        properties:
          device_id:
            type: string
          data:
            type: object
            additionalProperties:
              type: string
    
    sendEmailData:
      payload:
        type: object
        properties:
          user_email:
            type: string
          email_template_key:
            type: string
          body:
            type: string